
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ตรวจสอบพื้นที่จัดส่งพัสดุ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Kanit&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,1,0" />
    <style>
        body { font-family: 'Kanit', sans-serif; }
        .text-sm {
            font-size: small;
        }
        .text-xs {
            font-size: 10pt;
        }
    

        .grow {
            animation-name: spin;
  animation-duration: 500ms;
  animation-iteration-count: infinite;
  animation-timing-function: linear; 
        }

        @keyframes spin {
  0% {
    transform: scale(0);
  }
  50% {
    opacity: 1;
    transform: none;
  }
}

    </style>
</head>
  <body>
    <div class="container-md mt-3 text-center" id="bodyLoad">
    <h3 class="mt-5">ตรวจสอบพื้นที่จัดส่งพัสดุเคอรี่</h1>
    <p class="text-md text-danger">ไม่สามารถจัดส่งได้ รหัสไปรณีย์</p>
    <p class="text-sm mb-5">Last update: </p>

    <div class="my-3">
        <button class="btn btn-outline-secondary" type="button" id="close">Full Block</button>
        <button class="btn btn-outline-secondary" type="button" id="delayed">Delayed</button>
        <button class="btn btn-outline-secondary" type="button" id="block">Big Delayed</button>

    </div>


    <div class="input-group mb-3">
    <span class="input-group-text" id="basic-addon1"><span class="material-symbols-outlined">mail</span></span>
    <input type="text" class="form-control" placeholder="ค้นหาพื้นที่">
    <button class="btn btn-outline-secondary" type="button" id="search">Search</button>
    </div>

    <div id="response"></div>

    </div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
<script src="js/fetch.js"></script>
  
<script>

document.querySelector("#search").addEventListener("click", async () => {
    const response = await API({"action":"search","value":document.querySelector("input").value})
    document.querySelector("#response").innerHTML = render(response.data)
});

document.querySelector("#close").addEventListener("click", async () => {
    const response = await API({"action":"close"})
    document.querySelector("#response").innerHTML = render(response.data)
});
document.querySelector("#delayed").addEventListener("click", async () => {
    const response = await API({"action":"delayed"})
    document.querySelector("#response").innerHTML = render(response.data)
});
document.querySelector("#block").addEventListener("click", async () => {
    const response = await API({"action":"block"})
    document.querySelector("#response").innerHTML = render(response.data)
});


function render(data){
   
    if(!data){ return;}
    let html = `<table class="table table-sm table-striped table-hover">`
    data.forEach(element => {
        let icon = `<span class="material-symbols-outlined text-success">where_to_vote</span>`


        if(element.masterBlockSize.length){
            icon = `<span class="material-symbols-outlined text-warning">emergency_heat</span>`
            element.warningMessage = (!element.warningMessage)?`<span class="material-symbols-outlined">pallet</span><span class="text-sm">${element.masterBlockSize.length}</span>`:element.warningMessage

        }

        if(element.masterPostalCodeCapacities){
            icon = `<span class="material-symbols-outlined text-danger">emergency_heat</span>`
            element.warningMessage = (!element.warningMessage)?`<span class="text-sm">+${element.masterPostalCodeCapacities.serviceAdjust} วัน</span>`:element.warningMessage
        }

        if(element.inactive){
            icon = `<span class="material-symbols-outlined text-danger">wrong_location</span>`
        }

        html += `<tr>
            <td>${icon??''}</td>
            <td>${element.district}</td>
            <td>${element.amphur}</td>
            <td>${element.province}</td>
            <td class="text-xs align-middle text-danger">${element.warningMessage??''}</td>
            <td>${element.routeCode}</td>
            <td>${element.linehualRoute}</td>
            </tr>`
    });
    html += `</table>`

    return html
}



</script>
</body>
</html>